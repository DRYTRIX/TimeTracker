{% extends "base.html" %}
{% block title %}{{ _('Edit Kanban Column') }}{% endblock %}

{% block content %}
<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="mb-4">
        <h2>
          <i class="fas fa-edit text-primary"></i> {{ _('Edit Kanban Column') }}
        </h2>
        <p class="text-muted">{{ _('Modify column settings') }}</p>
      </div>

      <!-- Flash messages are globally converted to toasts in base.html -->

      <div class="card">
        <div class="card-body">
          <form method="POST" action="{{ url_for('kanban.edit_column', column_id=column.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <div class="mb-3">
              <label for="key" class="form-label">
                {{ _('Column Key') }}
              </label>
              <input type="text" 
                     class="form-control" 
                     id="key" 
                     value="{{ column.key }}" 
                     disabled>
              <small class="form-text text-muted">
                {{ _('The key cannot be changed after creation') }}
              </small>
            </div>

            <div class="mb-3">
              <label for="label" class="form-label">
                {{ _('Column Label') }} <span class="text-danger">*</span>
              </label>
              <input type="text" 
                     class="form-control" 
                     id="label" 
                     name="label" 
                     value="{{ column.label }}" 
                     required 
                     autofocus>
              <small class="form-text text-muted">
                {{ _('The display name shown on the kanban board') }}
              </small>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="icon" class="form-label">
                    {{ _('Icon Class') }}
                  </label>
                  <input type="text" 
                         class="form-control" 
                         id="icon" 
                         name="icon" 
                         value="{{ column.icon }}"
                         placeholder="fas fa-circle">
                  <small class="form-text text-muted">
                    {{ _('Font Awesome icon class') }} 
                    <a href="https://fontawesome.com/icons" target="_blank">{{ _('Browse icons') }}</a>
                  </small>
                  <div class="mt-2">
                    <span class="badge bg-light text-dark">
                      <i class="{{ column.icon }}"></i> {{ _('Preview') }}
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="color" class="form-label">
                    {{ _('Color') }}
                  </label>
                  <select class="form-select" id="color" name="color">
                    <option value="primary" {% if column.color == 'primary' %}selected{% endif %}>{{ _('Primary (Blue)') }}</option>
                    <option value="secondary" {% if column.color == 'secondary' %}selected{% endif %}>{{ _('Secondary (Gray)') }}</option>
                    <option value="success" {% if column.color == 'success' %}selected{% endif %}>{{ _('Success (Green)') }}</option>
                    <option value="danger" {% if column.color == 'danger' %}selected{% endif %}>{{ _('Danger (Red)') }}</option>
                    <option value="warning" {% if column.color == 'warning' %}selected{% endif %}>{{ _('Warning (Yellow)') }}</option>
                    <option value="info" {% if column.color == 'info' %}selected{% endif %}>{{ _('Info (Cyan)') }}</option>
                    <option value="dark" {% if column.color == 'dark' %}selected{% endif %}>{{ _('Dark') }}</option>
                  </select>
                  <small class="form-text text-muted">
                    {{ _('Bootstrap color class for styling') }}
                  </small>
                </div>
              </div>
            </div>

            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" 
                       type="checkbox" 
                       id="is_complete_state" 
                       name="is_complete_state"
                       {% if column.is_complete_state %}checked{% endif %}>
                <label class="form-check-label" for="is_complete_state">
                  {{ _('Mark as Complete State') }}
                </label>
                <small class="form-text text-muted d-block">
                  {{ _('Tasks moved to this column will be marked as completed') }}
                </small>
              </div>
            </div>

            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" 
                       type="checkbox" 
                       id="is_active" 
                       name="is_active"
                       {% if column.is_active %}checked{% endif %}>
                <label class="form-check-label" for="is_active">
                  {{ _('Active') }}
                </label>
                <small class="form-text text-muted d-block">
                  {{ _('Inactive columns are hidden from the kanban board') }}
                </small>
              </div>
            </div>

            <hr>

            <div class="d-flex justify-content-between">
              <a href="{{ url_for('kanban.list_columns') }}" class="btn btn-secondary">
                <i class="fas fa-times"></i> {{ _('Cancel') }}
              </a>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> {{ _('Save Changes') }}
              </button>
            </div>
          </form>
        </div>
      </div>

      {% if column.is_system %}
      <div class="alert alert-warning mt-4">
        <i class="fas fa-exclamation-triangle"></i>
        <strong>{{ _('System Column:') }}</strong>
        {{ _('This is a system column. You can customize its appearance but cannot delete it.') }}
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

