<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Failed</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">
    <div style="background-color: #dc3545; color: white; padding: 20px; border-radius: 5px 5px 0 0;">
        <h1 style="margin: 0;">⚠️ Payment Failed</h1>
    </div>
    
    <div style="background-color: #f8f9fa; padding: 20px; border: 1px solid #dee2e6; border-top: none; border-radius: 0 0 5px 5px;">
        <p>Hello {{ user.display_name }},</p>
        
        <p>We were unable to process your payment for <strong>{{ organization.name }}</strong>.</p>
        
        <div style="background-color: #fff; border-left: 4px solid #dc3545; padding: 15px; margin: 20px 0;">
            <p style="margin: 0;"><strong>Invoice Amount:</strong> {{ invoice.currency|upper }} {{ "%.2f"|format(invoice.amount_due / 100) }}</p>
            <p style="margin: 5px 0 0 0;"><strong>Attempt Count:</strong> {{ invoice.attempt_count }}</p>
        </div>
        
        <p><strong>What happens next?</strong></p>
        <ul>
            <li>We'll automatically retry the payment in a few days</li>
            <li>Your service will continue during this grace period</li>
            <li>If payment continues to fail, your subscription may be suspended</li>
        </ul>
        
        <p><strong>Action Required:</strong></p>
        <p>Please update your payment method to avoid service interruption:</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="{{ url_for('billing.portal', _external=True) }}" 
               style="display: inline-block; background-color: #dc3545; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; font-weight: bold;">
                Update Payment Method
            </a>
        </div>
        
        <p>If you have any questions or need assistance, please don't hesitate to contact us.</p>
        
        <p>Best regards,<br>
        The TimeTracker Team</p>
    </div>
    
    <div style="text-align: center; margin-top: 20px; color: #6c757d; font-size: 12px;">
        <p>This is an automated message from TimeTracker</p>
    </div>
</body>
</html>

